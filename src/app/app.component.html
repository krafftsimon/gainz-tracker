<div class="header">
  <div class="flex-spacer"></div>
  <div class="login-btn-wrapper">
    <button class="login-btn" (click)="onLogin()" *ngIf="!isLoggedIn()">
      Log in
    </button>
    <p *ngIf="loginHintActive" class="speech"> 
      <fa class="close-hint" name="times"></fa>
      Login to save progress 
    </p>
  </div>
  <button class="login-btn" (click)="onLogout()" *ngIf="isLoggedIn()">
    Log out
  </button>
  <button class="register-btn" (click)="onRegister()">
    Register
  </button>
</div>

<div class="router">
  <router-outlet></router-outlet>
</div>

<div class="modal" id="login-modal" *ngIf="modalActive">
  <div class="modal-content"  [@slideInModalContentAnimation]="modalContentState">
    <form 
        [formGroup]="myLoginForm"
        (ngSubmit)="onSubmitLogin()"
        class="login-form"
        *ngIf="loginFormActive"
        [@slideModalFormAnimation]="loginFormState">
      <div class="form-group">
        <label for="username">
          <fa name="user"></fa>
          Username
        </label>
        <input class="auth-input" type="text" id="username" formControlName="username">
      </div>
      <div class="form-group">
        <label for="password">
          <fa name="lock"></fa>
          Password
        </label>
        <input class="auth-input" type="password" id="password" formControlName="password">
      </div>
      <span [style.display]="isErrorMsgActive()" class="errormsg">
        <fa name="exclamation-circle"></fa> 
        {{errorMsg}} 
      </span>
      <button type="submit" [disabled]="!myLoginForm.valid">Log in</button>
      <div class="modal-links" (click)="toRegisterFromLogin()">Register</div>
      <div class="modal-links">Forgot password</div>
    </form>

    <form 
        [formGroup]="myRegisterForm"
        (ngSubmit)="onSubmitRegister()"
        class="register-form"
        *ngIf="registerFormActive"
        [@slideModalFormAnimation]="registerFormState">
      <div class="form-group">
        <label for="username">
          <fa name="user"></fa>
          Username
        </label>
        <input class="auth-input" type="text" id="username" formControlName="username">
        <div *ngIf="myRegisterForm.get('username').touched">
          <span class="errormsg" *ngIf="myRegisterForm.get('username').hasError('isUsernameUnique')"> Username is taken. </span>
          <span class="errormsg" *ngIf="myRegisterForm.get('username').hasError('required')"> This field is required. </span>
          <span class="errormsg" *ngIf="myRegisterForm.get('username').hasError('minlength')"> Enter at least 4 characters. </span>
        </div>
      </div>
      <div class="form-group">
        <label for="password">
          <fa name="lock"></fa>
          Password
        </label>
        <input class="auth-input" type="password" id="password" formControlName="password">
        <div *ngIf="myRegisterForm.get('password').touched">
          <span class="errormsg" *ngIf="myRegisterForm.get('password').hasError('required')"> This field is required. </span>
          <span class="errormsg" *ngIf="myRegisterForm.get('password').hasError('minlength')"> Enter at least 8 characters. </span>
        </div>
      </div>
      <div class="form-group">
        <label for="email">
          <fa name="envelope"></fa>
          Email
        </label>
        <input class="auth-input" type="email" id="email" formControlName="email">
        <div *ngIf="myRegisterForm.get('email').touched">
          <span class="errormsg" *ngIf="myRegisterForm.get('email').hasError('isEmailUnique')"> Email is taken. </span>
          <span class="errormsg" *ngIf="myRegisterForm.get('email').hasError('required')"> This field is required. </span>
          <span class="errormsg" *ngIf="myRegisterForm.get('email').hasError('pattern')"> Enter a valid email address. </span>
        </div>
      </div>
      <button type="submit" [disabled]="!myRegisterForm.valid">Register</button>
      <div class="modal-links" (click)="toLoginFromRegister()">Already have an account?</div>
    </form>

  </div>
</div>
